Bootstrap: docker
From: continuumio/miniconda3
   
%files
    ${HOME}/MONSDA/envs/base.yaml /opt/envs/
    ${HOME}/MONSDA/scripts /opt/MONSDA/
   
%environment
   
%post
    ls -alrt /opt/envs
    chmod -R +x /opt/envs/base.yaml
    
    ENV_NAME=monsda_base
    echo ". /opt/conda/etc/profile.d/conda.sh" >> $APPTAINER_ENVIRONMENT
    echo "conda activate $ENV_NAME" >> $APPTAINER_ENVIRONMENT
   
    . /opt/conda/etc/profile.d/conda.sh
    conda env create -f /opt/envs/base.yaml -p /opt/conda/envs/$ENV_NAME
    conda clean --all

%runscript
    exec "$@"
